{
  "name": "device.share.add.1.0.0",
  "method": "POST",
  "path": "/devices/(\\d+)/shares",
  "authentication": true,
  "scope": "device:share",
  "appkey": true,
  "app_code_vertify": true,
  "body.arg": [
    {
      "name": "name",
      "rules": {
        "maxLength": 64
      }
    },
    {
      "name": "friends",
      "rules": {
        "required": true,
        "list": true
      }
    },
    {
      "name": "shareStart",
      "rules": {
        "required": true,
        "integer": true,
        "min": 0,
        "max": 86400
      }
    },
    {
      "name": "shareEnd",
      "rules": {
        "required": true,
        "integer": true,
        "min": 0,
        "max": 86400
      }
    },
    {
      "name": "shareStartRepeat",
      "rules": {
        "required": true,
        "integer": true,
        "min": 0,
        "max": 127
      }
    },
    {
      "name": "shareEndRepeat",
      "rules": {
        "required": true,
        "integer": true,
        "min": 0,
        "max": 127
      }
    },
    {
      "name": "isTop",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authAlarmPush",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authDefendControl",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authIpcPlayback",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authIpcAlarm",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authIpcTalk",
      "rules": {
        "bool": true
      }
    },
    {
      "name": "authIpcCloud",
      "rules": {
        "bool": true
      }
    }
  ],
  "endpoints": [
    {
      "service": "device",
      "method": "POST",
      "name": "share_device",
      "type": "http",
      "path": "/devices/shares"
    }
  ],
  "request.transformer": [
    {
      "name": "share_device",
      "body.add": [
        "deviceId:$var.param0",
        "deviceId2:$header.deviceId",
        "userId:$user.userId",
        "companyCode:$user.companyCode"
      ],
      "header.add": [
        "x-auth-userId:$user.userId",
        "x-auth-username:$user.username",
        "x-auth-companyCode:$user.companyCode",
        "x-auth-fullname:$user.fullname",
        "x-auth-tel:$user.tel",
        "x-auth-mail:$user.mail",
        "x-auth-type:$user.type",
        "x-policy-owner:individual"
      ]
    }
  ]
}